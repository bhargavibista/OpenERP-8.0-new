<?xml version="1.0" encoding="UTF-8"?>

<openerp>
    <data>
        <record id="view_up_down_policy_filter" model="ir.ui.view">
            <field name="name">view.up.down.policy.filter</field>
            <field name="model">upgrade.downgrade.policy</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Upgrade/Downgrade">
                   <field name="name"/>
                   <field name="partner_id"/>
                </search>
            </field>
        </record>

        <record id="view_up_down_policy_tree_view" model="ir.ui.view">
            <field name="name">view.up.down.policy.tree.view</field>
            <field name="model">upgrade.downgrade.policy</field>
            <field name="type">tree</field>
            <field name="priority">2</field>
            <field name="arch" type="xml">
                <tree string="Upgrade/Downgrade">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="old_policy_id"/>
                    <field name="product_id"/>
		    <field name="up_down_service"/> 
                    <field name="date_create"/>
                    <field name="free_trial_date" invisible="1"/>
                    <field name="source"/>
                    <field name="user_id"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_up_down_policy_form_view" model="ir.ui.view">
            <field name="name">view.up.down.policy.form.view</field>
            <field name="model">upgrade.downgrade.policy</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Updrage/Downgrade" version="7.0">
                   <header>
                        <field name="state" widget="statusbar" statusbar_visible="draft,done"/>
                   </header>
                   <group>
                       <group>
                           <field name="name" readonly="1"/>
                            <field name="partner_id" on_change="onchange_partner_id(partner_id)" required="1" options="{'limit': 7 , 'create': false, 'create_edit': false ,'always_reload': True}"/>
                           <field name="old_policy_id" required="1" domain="[('agmnt_partner','=',partner_id),('active_service','=',True)]" options="{'limit': 20, 'create': false, 'create_edit': false ,'always_reload': True}"/> 
                            <!--<field name="new_policy_id" readonly="1"/>-->
                            <!--<field name="product_id" required="1" on_change="onchange_product_id(product_id,partner_id,old_policy_id,context)" domain="[('type','=','service'),('sale_ok','=',True),('recurring_service','=',True),('ext_prod_config','=',False),('magento_product_id','!=',0)]" options="{'limit': 20, 'create': false, 'create_edit': false ,'always_reload': True}"/>-->
                            <field name="product_id" required="1" on_change="onchange_product_id(product_id,partner_id,old_policy_id,context)" domain="[('type','=','service'),('sale_ok','=',True),('recurring_service','=',True),('ext_prod_config','=',False)]" options="{'limit': 20, 'create': false, 'create_edit': false ,'always_reload': True}"/>
                            <field name="up_down_service" required="1"/>
                            <field name="previous_package_prorated_price" readonly="1" attrs="{'invisible':[('source','=','COX')]}"/>
                            <field name="new_package_prorated_price" readonly="1" attrs="{'invisible':[('source','=','COX')]}" />

                        </group>
                        <group>
                            <field name="date_create" readonly="1"/>
                            <field name="start_date" invisible="1"/>
                            <field name="free_trial_date" invisible="1"/>
                            <field name="source" readonly="1"/>
                            <field name="user_id" readonly="1"/>
                            <field name="previous_package_price" readonly="1" attrs="{'invisible':[('source','=','COX')]}"/>
                            <field name="new_package_price" readonly="1" attrs="{'invisible':[('source','=','COX')]}"/>
                        </group>
                   </group>
                   
                        <newline/>
                        <button name="upgrade_downgrade" string="Upgarde/Downgrade" context="{'partner_id':partner_id}" type="object" attrs="{'invisible':[('state','=','done')]}"/>
                </form>
            </field>
        </record>
        <record id="action_updrade_downgrade_policy" model="ir.actions.act_window">
            <field name="name">Upgrade/Downgrade</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">upgrade.downgrade.policy</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_up_down_policy_tree_view"/>
        </record>
        <menuitem action="action_updrade_downgrade_policy" id="menu_updrade_downgrade_policy" parent="base.menu_sales" />
    </data>
</openerp>
